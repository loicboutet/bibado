<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Bibado - Weaning With Meaning" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <style>
      /* Bibado brand colors */
      :root {
        --bibado-coral: #FF6B6B;
        --bibado-coral-dark: #E85555;
        --bibado-teal: #4ECDC4;
        --bibado-teal-dark: #3DB9B0;
        --bibado-yellow: #FFE66D;
        --bibado-cream: #FFF9E6;
        --bibado-navy: #2C3E50;
        --bibado-gray: #95A5A6;
      }
      
      .bg-bibado-coral { background-color: var(--bibado-coral); }
      .bg-bibado-teal { background-color: var(--bibado-teal); }
      .bg-bibado-yellow { background-color: var(--bibado-yellow); }
      .bg-bibado-cream { background-color: var(--bibado-cream); }
      .bg-bibado-navy { background-color: var(--bibado-navy); }
      
      .text-bibado-coral { color: var(--bibado-coral); }
      .text-bibado-teal { color: var(--bibado-teal); }
      .text-bibado-navy { color: var(--bibado-navy); }
      
      .border-bibado-coral { border-color: var(--bibado-coral); }
      .border-bibado-teal { border-color: var(--bibado-teal); }
      
      /* Mobile phone frame for desktop preview */
      @media (min-width: 640px) {
        .mobile-frame {
          max-width: 390px;
          margin: 20px auto;
          border-radius: 40px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          overflow: hidden;
          border: 12px solid #1a1a1a;
        }
      }
      
      /* Safe area for notch */
      .safe-area-top { padding-top: env(safe-area-inset-top, 20px); }
      .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom, 20px); }
    </style>
  </head>

  <body class="bg-gray-100 min-h-screen">
    <!-- Mobile frame wrapper for desktop preview -->
    <div class="mobile-frame bg-white min-h-screen flex flex-col" data-controller="mobile-menu">
      
      <!-- Header with burger menu -->
      <header class="bg-bibado-coral text-white safe-area-top sticky top-0 z-50">
        <div class="flex items-center justify-between px-4 py-3">
          <!-- Burger menu button -->
          <button class="p-2 -ml-2 rounded-lg hover:bg-white/10 transition-colors" data-action="click->mobile-menu#toggle">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
          
          <!-- Logo/Title -->
          <div class="flex items-center gap-2">
            <span class="font-bold text-lg tracking-tight">Bibado</span>
          </div>
          
          <!-- Search button -->
          <button class="p-2 -mr-2 rounded-lg hover:bg-white/10 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </button>
        </div>
      </header>
      
      <!-- Slide-out menu -->
      <div data-mobile-menu-target="menu" class="fixed inset-0 z-50 hidden">
        <!-- Overlay -->
        <div data-mobile-menu-target="overlay" data-action="click->mobile-menu#closeOnOverlay" class="absolute inset-0 bg-black/50"></div>
        
        <!-- Menu panel -->
        <nav class="absolute left-0 top-0 bottom-0 w-72 bg-white shadow-xl transform transition-transform">
          <div class="bg-bibado-coral text-white p-6 safe-area-top">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
              </div>
              <div>
                <p class="font-semibold">Welcome!</p>
                <p class="text-sm opacity-80">Weaning <%= baby_name rescue 'Oliver' %></p>
              </div>
            </div>
          </div>
          
          <div class="py-4">
            <%= render 'mockups/shared/menu_items' %>
          </div>
        </nav>
      </div>

      <!-- Main content area -->
      <main class="flex-1 overflow-y-auto pb-20">
        <%= yield %>
      </main>

      <!-- Bottom navigation -->
      <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 safe-area-bottom z-40 sm:max-w-[390px] sm:mx-auto sm:left-1/2 sm:-translate-x-1/2">
        <div class="flex justify-around items-center py-2">
          <%= render 'mockups/shared/bottom_nav_item', icon: 'home', label: 'Home', path: mockups_root_path, active: controller_name == 'home' %>
          <%= render 'mockups/shared/bottom_nav_item', icon: 'foods', label: 'Foods', path: mockups_foods_path, active: controller_name == 'foods' %>
          <%= render 'mockups/shared/bottom_nav_item', icon: 'meals', label: 'Meals', path: mockups_meals_path, active: controller_name == 'meals' %>
          <%= render 'mockups/shared/bottom_nav_item', icon: 'plan', label: 'Plan', path: mockups_meal_plan_path, active: controller_name == 'meal_plan' %>
          <%= render 'mockups/shared/bottom_nav_item', icon: 'more', label: 'More', path: '#', active: false, data: { action: 'click->mobile-menu#toggleMore' } %>
        </div>
      </nav>
    </div>
  </body>
</html>
